# üöß BLOCKED - Manual Railway Configuration Required

**Date**: 2025-10-28  
**Sprint**: 4.1 - Deploy Celery Workers on Railway  
**Blocking**: Full production automation

---

## What's Needed

The following steps require **manual configuration in Railway dashboard** by a human with access:

### 1. Add Redis Database (if not already added)

**Steps**:
1. Go to Railway dashboard: https://railway.app
2. Navigate to AGI Tracker project
3. Click "+ New" ‚Üí "Database" ‚Üí "Redis"
4. Railway will automatically create `REDIS_URL` environment variable
5. Verify Redis is connected and running

**Status**: ‚è∏Ô∏è Pending human action

---

### 2. Create Celery Worker Service

**Steps**:
1. In Railway project, click "+ New" ‚Üí "Service"
2. Select "GitHub Repo" ‚Üí `hankthevc/AGITracker`
3. Configure service:
   - **Name**: `agi-tracker-celery-worker`
   - **Root Directory**: `services/etl`
   - **Start Command**: `celery -A app.celery_app worker --loglevel=info`
4. Copy all environment variables from main API service
5. Click "Deploy"
6. Verify logs show: "celery@hostname ready"

**Status**: ‚è∏Ô∏è Pending human action

---

### 3. Create Celery Beat Service (Scheduler)

**Steps**:
1. In Railway project, click "+ New" ‚Üí "Service"
2. Select "GitHub Repo" ‚Üí `hankthevc/AGITracker`
3. Configure service:
   - **Name**: `agi-tracker-celery-beat`
   - **Root Directory**: `services/etl`
   - **Start Command**: `celery -A app.celery_app beat --loglevel=info`
4. Copy all environment variables from main API service
5. Click "Deploy"
6. Verify logs show: "Scheduler: Sending due task..."

**Status**: ‚è∏Ô∏è Pending human action

---

## Environment Variables to Copy

Ensure these variables are set on **all three services** (API, Worker, Beat):

```bash
# Required
DATABASE_URL=<from Neon>
REDIS_URL=<auto-generated by Railway Redis>
OPENAI_API_KEY=<your OpenAI key>
ADMIN_API_KEY=<your admin key>

# Optional but recommended
ENVIRONMENT=production
LOG_LEVEL=info
CORS_ORIGINS=https://agi-tracker.vercel.app
LLM_BUDGET_DAILY_USD=50
```

---

## Verification Steps (After Setup)

Once services are deployed, verify with these commands:

```bash
# Check worker logs
railway logs -s agi-tracker-celery-worker

# Check beat logs
railway logs -s agi-tracker-celery-beat

# Test Redis connection
railway run -s agi-tracker-api python -c "import redis; r=redis.from_url('$REDIS_URL'); print('‚úÖ Redis:', r.ping())"

# Check task health endpoint
curl https://agi-tracker-production.up.railway.app/v1/admin/tasks/health \
  -H "x-api-key: YOUR_API_KEY"
```

---

## What I Can Do While Blocked

While waiting for Railway setup, I've implemented:

- ‚úÖ Task health monitoring endpoint (`/v1/admin/tasks/health`)
- ‚úÖ Task dashboard UI (`/admin/tasks`)
- ‚úÖ Healthchecks.io integration support
- ‚úÖ All Celery task definitions and schedules
- ‚úÖ Task tracking utilities

These will work automatically once the Railway services are deployed.

---

## Cost Estimate

**Monthly costs after setup**:
- Redis: ~$0 (included in Railway usage)
- Celery Worker: ~$5-10/month
- Celery Beat: ~$2-5/month
- **Total**: ~$7-15/month additional

---

## Next Steps

1. ‚è∏Ô∏è **BLOCKED**: Human needs to configure Railway services above
2. ‚úÖ **COMPLETED**: Task monitoring code (Sprint 4.2) - Ready to use
3. ‚è≥ **READY**: Continue with Sprint 5 tasks (can work in parallel)

---

## Contact

Once Railway services are deployed, please:
1. Verify all 3 services are running
2. Check logs for errors
3. Test the task health endpoint
4. Update this file with ‚úÖ when complete
5. Continue to Sprint 5 implementation

**Expected time**: 15-30 minutes of manual configuration
